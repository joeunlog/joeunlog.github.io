<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>2021-05-13 - Joeunlog</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>2021-05-13 | Joeunlog</title> <meta name="generator" content="Jekyll v4.2.0" /> <meta property="og:title" content="2021-05-13" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description." /> <meta property="og:description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description." /> <link rel="canonical" href="/docs/daily-learning-log/20210513.html" /> <meta property="og:url" content="/docs/daily-learning-log/20210513.html" /> <meta property="og:site_name" content="Joeunlog" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="2021-05-13" /> <script type="application/ld+json"> {"@type":"WebPage","url":"/docs/daily-learning-log/20210513.html","description":"Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.","headline":"2021-05-13","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/" class="site-title lh-tight"> Joeunlog </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/docs/" class="nav-list-link">Joeunvit Study log</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/project/" class="nav-list-link">PROJECT</a><ul class="nav-list "><li class="nav-list-item "><a href="/docs/project/awseks-semiproject.html" class="nav-list-link">AWS EKS semi project</a></li><li class="nav-list-item "><a href="/docs/project/final-project.html" class="nav-list-link">Final project</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/python-study/" class="nav-list-link">Python</a><ul class="nav-list "><li class="nav-list-item "><a href="/docs/python-study/01-set-environment.html" class="nav-list-link">Setting environment</a></li><li class="nav-list-item "><a href="/docs/python-study/02-data-type.html" class="nav-list-link">Data type</a></li></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/daily-learning-log/" class="nav-list-link">Daily-learning-log</a><ul class="nav-list "><li class="nav-list-item "><a href="/docs/daily-learning-log/20210127.html" class="nav-list-link">2021-01-27</a></li><li class="nav-list-item "><a href="/docs/daily-learning-log/20210128.html" class="nav-list-link">2021-01-28</a></li><li class="nav-list-item "><a href="/docs/daily-learning-log/20210129.html" class="nav-list-link">2021-01-29</a></li><li class="nav-list-item "><a href="/docs/daily-learning-log/20210201.html" class="nav-list-link">2021-02-01</a></li><li class="nav-list-item "><a href="/docs/daily-learning-log/20210205.html" class="nav-list-link">2021-02-05</a></li><li class="nav-list-item "><a href="/docs/daily-learning-log/20210329.html" class="nav-list-link">2021-03-29</a></li><li class="nav-list-item "><a href="/docs/daily-learning-log/20210330.html" class="nav-list-link">2021-03-30</a></li><li class="nav-list-item "><a href="/docs/daily-learning-log/20210331.html" class="nav-list-link">2021-03-31</a></li><li class="nav-list-item "><a href="/docs/daily-learning-log/20210401.html" class="nav-list-link">2021-04-01</a></li><li class="nav-list-item "><a href="/docs/daily-learning-log/20210405.html" class="nav-list-link">2021-04-05</a></li><li class="nav-list-item "><a href="/docs/daily-learning-log/20210406.html" class="nav-list-link">2021-04-06</a></li><li class="nav-list-item "><a href="/docs/daily-learning-log/20210407.html" class="nav-list-link">2021-04-07</a></li><li class="nav-list-item "><a href="/docs/daily-learning-log/20210408.html" class="nav-list-link">2021-04-08</a></li><li class="nav-list-item "><a href="/docs/daily-learning-log/20210409.html" class="nav-list-link">2021-04-09</a></li><li class="nav-list-item "><a href="/docs/daily-learning-log/20210420.html" class="nav-list-link">2021-04-20</a></li><li class="nav-list-item "><a href="/docs/daily-learning-log/20210421.html" class="nav-list-link">2021-04-21</a></li><li class="nav-list-item "><a href="/docs/daily-learning-log/20210422.html" class="nav-list-link">2021-04-22</a></li><li class="nav-list-item "><a href="/docs/daily-learning-log/20210423.html" class="nav-list-link">2021-04-23</a></li><li class="nav-list-item "><a href="/docs/daily-learning-log/20210426.html" class="nav-list-link">2021-04-26</a></li><li class="nav-list-item "><a href="/docs/daily-learning-log/20210427.html" class="nav-list-link">2021-04-27</a></li><li class="nav-list-item "><a href="/docs/daily-learning-log/20210428.html" class="nav-list-link">2021-04-28</a></li><li class="nav-list-item "><a href="/docs/daily-learning-log/20210429.html" class="nav-list-link">2021-04-29</a></li><li class="nav-list-item "><a href="/docs/daily-learning-log/20210503.html" class="nav-list-link">2021-05-03</a></li><li class="nav-list-item "><a href="/docs/daily-learning-log/20210504.html" class="nav-list-link">2021-05-04</a></li><li class="nav-list-item "><a href="/docs/daily-learning-log/20210506.html" class="nav-list-link">2021-05-06</a></li><li class="nav-list-item "><a href="/docs/daily-learning-log/20210507.html" class="nav-list-link">2021-05-07</a></li><li class="nav-list-item "><a href="/docs/daily-learning-log/20210510.html" class="nav-list-link">2021-05-10</a></li><li class="nav-list-item "><a href="/docs/daily-learning-log/20210511.html" class="nav-list-link">2021-05-11</a></li><li class="nav-list-item "><a href="/docs/daily-learning-log/20210512.html" class="nav-list-link">2021-05-12</a></li><li class="nav-list-item active"><a href="/docs/daily-learning-log/20210513.html" class="nav-list-link active">2021-05-13</a></li><li class="nav-list-item "><a href="/docs/daily-learning-log/20210514.html" class="nav-list-link">2021-05-14</a></li><li class="nav-list-item "><a href="/docs/daily-learning-log/20210517.html" class="nav-list-link">2021-05-17</a></li><li class="nav-list-item "><a href="/docs/daily-learning-log/20210518.html" class="nav-list-link">2021-05-18</a></li><li class="nav-list-item "><a href="/docs/daily-learning-log/20210521.html" class="nav-list-link">2021-05-21</a></li><li class="nav-list-item "><a href="/docs/daily-learning-log/20211025.html" class="nav-list-link">2021-10-25</a></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Joeunlog" aria-label="Search Joeunlog" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/docs/daily-learning-log/">Daily-learning-log</a></li> <li class="breadcrumb-nav-list-item"><span>2021-05-13</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1> Kubernetes </h1> <h2> kubernetes version skew(차이) </h2> <p>각 버전은 1년간 지원 : 1년 지나기 전에 업데이트 해야 보안상 안전</p> <p>참고주소</p> <blockquote> <p>https://kubernetes.io/ko/docs/setup/release/version-skew-policy/</p> </blockquote> <blockquote> <p>https://github.com/kubernetes/kubernetes</p> </blockquote> <ul> <li>업그레이드 목록 <ul> <li>kube-apiserver ; +1</li> <li>kubelet ; -2</li> <li>kube-controller-manager ; -1</li> <li>kube-scheduler ; -1</li> <li>kube-cloud-controller-manager ; -1</li> <li>kubectl ; +-1</li> </ul> </li> </ul> <h3> 순차적 업데이트 원리 </h3> <p>동시에 업데이트 해버리면 cluster가 멈추게 되므로 순차적인 업데이트 필요</p> <p>순차적으로 업데이트 하는 와중에는 클러스터 내에서도 버전 차이가 발생하게 됨</p> <p>docs의 skew-policy에서 지원되는 버전 차이에 대한 내용을 명시함</p> <p>이 차이를 확인하고, 순차적으로 업데이트 진행</p> <p>즉, 현재 3개의 component가 1.20이며 1.21로 업데이트하고 한다면 docs의 skew 중 1.21과 1.20이 호환된다는 것을 확인한 뒤 각 component들을 순차적으로 업데이트</p> <ul> <li>skew에 따라 정해지는 업데이트 순서 ; ansible이 자동으로 해줌 ; 내용만 이해하자 ! <ol> <li>kube-apiserver</li> <li>kube-contoller-manager, kube-scheduler, kube-cloud-controller-manager</li> <li>kubelet</li> <li>kube-proxy</li> <li>kubectl</li> </ol> </li> </ul> <h3> 업그레이드 </h3> <p>참고주소</p> <blockquote> <p>https://kubespray.io/#/docs/upgrades</p> </blockquote> <p>프로메테우스 실습 하려고 하는데 resource를 많이 차지하니까</p> <ul> <li>노드 하나 제거</li> <li>나머지 노드들 resource(cpu,memory) 늘려주고</li> <li>master도 worker로 사용할 수 있도록 변경</li> </ul> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># delete node : ~/kubespray 에서!</span>
ansible-playbook <span class="nt">-i</span> inventory/mycluster/inventory.ini remove-node.yml <span class="nt">-b</span> <span class="nt">-e</span> <span class="s2">"node=k8s-w3"</span>
<span class="c"># 잘 제거 됐는지 확인</span>
kubectl get nodes

<span class="c"># inventory.ini file 수정</span>
all, node에서 k8s-w3 주석처리
node에 k8s-m1 추가
<span class="c"># 업그레이드 하면 k8s-m1의 Taint가 자동으로 해제되어 있을 것</span>

<span class="c"># graceful update 실행 : node를 cordon해야하는데 master는 1개뿐이라 cordon하면 멈춰버려서 안됐던 것 !</span>
<span class="c"># 따라서 unsafe upgrade 해야함</span>
ansible-playbook <span class="nt">-i</span> inventory/mycluster/inventory.ini upgrade-cluster.yml <span class="nt">-b</span> <span class="nt">-e</span> <span class="nv">kube_version</span><span class="o">=</span>v1.19.10
<span class="c"># 에러떴음 ! 아래는 에러 없애는 과정</span>
<span class="nb">cp </span>inventory/mycluster/inventory.ini ~
<span class="nb">cd
rm</span> <span class="nt">-rf</span> kubespray/
git clone <span class="nt">-b</span> release-2.15 https://github.com/kubernetes-sigs/kubespray.git
<span class="nb">cd </span>kubespray/
<span class="nb">cp</span> <span class="nt">-r</span> inventory/sample inventory/mycluster
<span class="nb">cp</span> ~/inventory.ini inventory/mycluster/
<span class="c"># update 다시 실행</span>
ansible-playbook <span class="nt">-i</span> inventory/mycluster/inventory.ini upgrade-cluster.yml <span class="nt">-b</span> <span class="nt">-e</span> <span class="nv">kube_version</span><span class="o">=</span>v1.19.10

<span class="c"># unsafe upgrade</span>
ansible-playbook <span class="nt">-i</span> inventory/mycluster/inventory.ini cluster.yml <span class="nt">-b</span> <span class="nt">-e</span> <span class="nv">kube_version</span><span class="o">=</span>v1.19.10 <span class="nt">-e</span> <span class="nv">upgrade_cluster_setup</span><span class="o">=</span><span class="nb">true</span>
<span class="c"># update 잘 됐는지 확인</span>
kubectl get nodes

<span class="c"># w3 VM halt : window에서</span>
vagrant halt k8s-w3
<span class="c"># 잘 중단됐는지 확인</span>
vagrant status
<span class="c"># vagrantfile 수정</span>
vagrant file에서 w3부분 주석처리
m1, w1, w2 resource 수정 : memory 3060
w3의 disk를 m1으로 옮김
<span class="c"># VM 재부팅</span>
vagrant reload
</code></pre></div></div> <h2> Prometheus </h2> <p>monitoring tool</p> <ul> <li>Infrastructure <ul> <li>BM, VM, Container : CPU, Memory, Disk, Network</li> <li>Kubernetes cluster</li> </ul> </li> <li>Application <ul> <li>APM : Application Performance Monitor <ul> <li>http 요청/응답 : RTT</li> </ul> </li> <li>http 응답 시간</li> <li>http 응답 코드</li> </ul> </li> <li>쿠버네티스에서 모니터링 <ul> <li>Heapster + influxdb : 메트릭 저장 ; 프로젝트가 중단되었음</li> <li>metrics-server : cpu, memory 실시간 모니터링만 가능</li> <li>Prometheus <ul> <li>Thanos, coretex를 이용하여 long term도 가능</li> </ul> </li> </ul> </li> </ul> <h3> Prometheus Architecture </h3> <p>참고주소</p> <blockquote> <p>https://prometheus.io/docs/introduction/overview/</p> </blockquote> <p>node에 pod 형태로 배포</p> <p>측정 값들을 Retrieval(회수)</p> <p>service discovery : kubernetes의 api server한테 질의해서 측정대상 확인</p> <p>길게 실행하는 것들은 그 자체를 pull해서 데이터를 수집</p> <p>금방 실행되고 없어지는 것들은 pushgateway에 가지고 있다가 pull해서 데이터 수집</p> <p>TSDB : Time Series DB : 시계열 데이터베이스 ; 시간대 별로 그래프가 그려져야하는 것들을 다룸</p> <p>PromQL : prometheus 전용 query language</p> <p>참고주소</p> <blockquote> <p>https://github.com/prometheus/prometheus</p> </blockquote> <h3> Prometheus 설치 </h3> <p>참고주소</p> <blockquote> <p>https://github.com/prometheus-operator/prometheus-operator</p> </blockquote> <p>prometheus 설치할 때에는 prometheus-operator로 설치 !</p> <p>rook-ceph 설치할 때도 똑같았음. operator가 먼저 생성되고 operator가 구성요소들을 순차적으로 생성</p> <p>원래 쿠버네티스는 선언형이라서 순서를 지정해서 뭘 만들기가 힘듬</p> <p>그래서 operator를 이용하여 순차적으로 진행할 수 있도록 하는 것</p> <p>operator는 operator SDK로 만듬</p> <p>참고주소</p> <blockquote> <p>https://github.com/prometheus-community/helm-charts/tree/main/charts/kube-prometheus-stack</p> </blockquote> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># prometheus repo 추가</span>
helm repo add prometheus-community https://prometheus-community.github.io/helm-charts
<span class="c"># repo update</span>
helm repo update

<span class="c"># value.yaml 내용 확인 : 필요하면 수정</span>
helm show values prometheus-community/kube-prometheus-stack <span class="o">&gt;</span> prom-value.yaml

<span class="c"># prometheus 릴리즈 + 전용 namespace 구성</span>
helm <span class="nb">install </span>monitor prometheus-community/kube-prometheus-stack <span class="nt">--namespace</span> prometheus <span class="nt">--create-namespace</span>

<span class="c"># grafana를 loadbalancer로 upgrade</span>
<span class="nb">rm </span>prom-value.yaml
<span class="c"># 아까 만든 prom-value.yaml 파일 지우고 다시 생성</span>
vi prom-value.yaml

grafana:
  service:
    <span class="nb">type</span>: LoadBalancer
<span class="c"># upgrade</span>
helm upgrade <span class="nt">-n</span> prometheus <span class="nt">-f</span> prom-value.yaml monitor prometheus-community/kube-prometheus-stack
<span class="c"># 접속</span>
kubectl get all <span class="nt">-n</span> prometheus
<span class="c"># grafana loadbalancer external-ip 확인 : 192.168.201.200 : chrome으로 접속</span>
<span class="c"># id : admin</span>
<span class="c"># password : prom-operator</span>
<span class="c"># 맨 위에 home 버튼 누르면 general dashboard 선택 가능</span>
</code></pre></div></div> <h3> ECK operator 설치 </h3> <p>참조주소</p> <blockquote> <p>https://www.elastic.co/guide/en/cloud-on-k8s/current/k8s-install-helm.html#k8s-install-helm</p> </blockquote> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>helm repo add elastic https://helm.elastic.co
helm repo update

helm <span class="nb">install </span>eck elastic/eck-operator <span class="nt">-n</span> logging <span class="nt">--create-namespace</span>
</code></pre></div></div> <h3> Elasticsearch 설치 </h3> <p>참조주소</p> <blockquote> <p>https://www.elastic.co/guide/en/cloud-on-k8s/current/k8s-deploy-elasticsearch.html</p> </blockquote> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>apiVersion: elasticsearch.k8s.elastic.co/v1
kind: Elasticsearch
metadata:
  name: elasticsearch
  namespace: logging
spec:
  version: 7.12.1
  nodeSets:
  - name: default
    count: 1
    config:
      node.store.allow_mmap: <span class="nb">false</span>


</code></pre></div></div> <blockquote> <p>elasticsearch는 custom resource : crd를 이용하여 새로운 resource를 만든 것</p> </blockquote> <h3> Kibana </h3> <p>참조 주소</p> <blockquote> <p>https://www.elastic.co/guide/en/cloud-on-k8s/current/k8s-deploy-kibana.html</p> </blockquote> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>apiVersion: kibana.k8s.elastic.co/v1
kind: Kibana
metadata:
  name: kibana
  namespace: logging
spec:
  version: 7.12.1
  count: 1
  elasticsearchRef:
    name: elasticsearch
  http:
    service:
      spec:
        <span class="nb">type</span>: LoadBalancer
</code></pre></div></div> <h3> Filebeat </h3> <p>참조 주소</p> <blockquote> <p>https://www.elastic.co/guide/en/cloud-on-k8s/current/k8s-beat-quickstart.html</p> </blockquote> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>apiVersion: beat.k8s.elastic.co/v1beta1
kind: Beat
metadata:
  name: filebeat
  namespace: logging
spec:
  <span class="nb">type</span>: filebeat
  version: 7.12.1
  elasticsearchRef:
    name: elasticsearch
  config:
    filebeat.inputs:
    - <span class="nb">type</span>: container
      paths:
      - /var/log/containers/<span class="k">*</span>.log
  daemonSet:
    podTemplate:
      spec:
        dnsPolicy: ClusterFirstWithHostNet
        hostNetwork: <span class="nb">true
        </span>securityContext:
          runAsUser: 0
        containers:
        - name: filebeat
          volumeMounts:
          - name: varlogcontainers
            mountPath: /var/log/containers
          - name: varlogpods
            mountPath: /var/log/pods
          - name: varlibdockercontainers
            mountPath: /var/lib/docker/containers
        volumes:
        - name: varlogcontainers
          hostPath:
            path: /var/log/containers
        - name: varlogpods
          hostPath:
            path: /var/log/pods
        - name: varlibdockercontainers
          hostPath:
            path: /var/lib/docker/containers
</code></pre></div></div> <h3> Elastic ID/PW </h3> <p>ID : elastic</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl get secret <span class="nt">-n</span> logging elasticsearch-es-elastic-user <span class="nt">-o</span> yaml

kubectl get secret <span class="nt">-n</span> logging elasticsearch-es-elastic-user <span class="nt">-o</span> <span class="nv">jsonpath</span><span class="o">=</span><span class="s1">'{.data.elastic}'</span> | <span class="nb">base64</span> <span class="nt">-d</span>
</code></pre></div></div> <p>address : https://x.x.x.x:5601/</p> <ul> <li>메뉴 Analytics -&gt; Discover</li> <li>Create index patten 버튼</li> <li>step1: <ul> <li>index pattern name: “filebeat-*”</li> </ul> </li> <li>step2: <ul> <li>Time field: @timestamp</li> </ul> </li> <li>메뉴 Analytics -&gt; Discover</li> </ul> <h2> EKS </h2> <ul> <li>EKS <ul> <li>관리형 쿠버네티스 : 사용자는 workernode만 관리 <ul> <li>AWS EKS : cluster 1개 시간당 $0.1</li> <li>Azure AKS</li> <li>Google GKE</li> <li>Oracle OKE</li> </ul> </li> <li>설치형 쿠버네티스 : 사용자가 모두 관리 (master도) <ul> <li>kops</li> <li>kubespray</li> <li>kubeadm</li> </ul> </li> </ul> </li> </ul> <h2> AWS EKS </h2> <p>시작하는 방법 2가지</p> <ol> <li>콘솔 : EKS가 사용할 AWS상의 role을 따로 만들어줘야함 : 복잡!</li> <li>eksctl</li> </ol> <h3> eksctl로 AWS EKS 구성 </h3> <p>참조 주소</p> <blockquote> <p>https://eksctl.io/</p> </blockquote> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># awscli 설치</span>
choco <span class="nb">install </span>awscli

<span class="c"># aws-iam-authenticator 설치</span>
choco <span class="nb">install </span>aws-iam-authenticator

<span class="c"># ekscli 설치</span>
choco <span class="nb">install </span>eksctl

<span class="c"># kubectl 설치</span>
choco <span class="nb">install </span>kubectl

<span class="c"># aws 자격증명 설정</span>
aws configure

accesskey
secretkey
region: ap-northeast-2

<span class="c"># eks 클러스터 생성</span>
eksctl create cluster <span class="se">\</span>
  <span class="nt">--name</span> mycluster <span class="se">\</span>
  <span class="nt">--region</span> ap-northeast-2 <span class="se">\</span>
  <span class="nt">--version</span> 1.18 <span class="se">\</span>
  <span class="nt">--nodegroup-name</span> mynodegroup <span class="se">\</span>
  <span class="nt">--nodes</span> 3 <span class="se">\</span>
  <span class="nt">--managed</span>

<span class="c"># eks 클러스터 삭제</span>
eksctl delete cluster mycluster
</code></pre></div></div> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
